clear; clc; close all

caliperData = readtable("DrawWireCal.xlsx","NumHeaderLines",3);
counterData = load("DrawWireCal20240701.mat");

caliperVals = table2array(caliperData(:,"Var2"))/1000; % convert from mm to m

counter = counterData.data.Data;
time = counterData.data.Time;

plot(time,counter)
ylim([33300000 33333333])

counterVals = ...
   [33325842; ...
   33325126; ...
   33324145; ...
   33322910; ...
   33320952; ...
   33319922; ...
   33318792; ...
   33318216; ...
   33317126; ...
   33316051; ...
   33314869; ...
   33313958; ...
   33313782];

figure
plot(counterVals,caliperVals,'*')
xlabel('Counter Values (counts)')
ylabel('displacement(m)')

[c,S] = polyfit(counterVals,caliperVals,1);
R_squared = 1-(S.normr/norm(caliperVals-mean(caliperVals)))^2
y_est = polyval(c,counterVals);
hold on
plot(counterVals,y_est,'r--','LineWidth',2)

